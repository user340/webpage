<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<title>e-yuuki.org</title>
</head>
<body><div class="tiny">
<h1>Unixコマンドラインの操作方法</h1>
<hr>
<p>コマンドラインの操作方法は覚えることが多く学習に苦労します。しかしCUI（Character User Interface）上でのコマンド操作を覚えると、高速にファイルの探索やテキスト編集ができます。普段使いの環境ならともかくサーバ運用をするとなると、コマンド操作を使わざるを得ないような状況に出くわします。Unixコマンドは覚えておいて損はないでしょう。</p>

<p>一方で実際にCUI上で作業する必要があるにしても、操作の手順書が用意されているか、実行すべきコマンドが限られている・明記されている場合がほとんどです。たとえば「このディレクトリ（directory）に移動してこのコマンドを実行せよ」、「このファイル（file）をこのように編集してこのコマンドを実行せよ」といった具合です。このような指示が与えられたのであれば、特定のディレクトリに移動する方法さえわかってさえいればいいのです。したがって、このページでは必要最低限のコマンドのみを紹介するにとどめます。</p>

<p>なお、本ページのコマンド実行例はすべてNetBSD-current/amd64上で確認したものであり、他バージョンや別アーキテクチャ・他プラットフォーム上でまったく同じ動作ができることを保証するものではありません。しかし本ページ上で述べている内容は多少の差はあれどFreeBSDやGNU/Linuxディストリビューションでも共通しています。</p>

<ol>
<li><a href="#path">絶対パスと相対パス</a></li>
<li><a href="#pwd">現在位置を確認する</a></li>
<li><a href="#ls">ディレクトリの中身を見る</a></li>
<li><a href="#cd">ディレクトリを移動する</a></li>
<li><a href="#mkdir">ディレクトリを作る</a></li>
<li><a href="#rmdir">ディレクトリを消す</a></li>
<li><a href="#less">ファイルの中身を見る</a></li>
<li><a href="#mv">ファイルを移動する・名前を変える</a></li>
<li><a href="#rm">ファイルを消す</a></li>
</ol>

<h2 id="path">絶対パスと相対パス</h2>
<p>Unixのシステムは図1-1のように木構造となっています。頂点のルートディレクトリ（root directory）から枝が伸び、俯瞰すると樹木のようなかたちになっているわけです。</p>

<figure style="text-align:center;">
<img src="./img/usage_001.png" alt="Example of unix directory hiearchy">
<figcaption><b>図1-1: </b>Unixのディレクトリ構造の例。スペースの都合上省略していますが、実際はもっとディレクトリやファイルが存在します。この図では一部のみ抜粋しています。</figcaption>
</figure>

<p>頂点のルートディレクトリから見たディレクトリやファイルの所在を「絶対パス（absolute path）」と呼びます。ユーザが位置しているディレクトリを「カレントディレクトリ（current directory）」と呼びますが、そのカレントディレクトリから見たディレクトリやファイルの所在を「相対パス（relative path）」と呼びます。たとえば図1-2を見てください。図中のファイル<b>myprog</b>のパスは<b>/home/uki/src/myprog</b>です。一方<b>/home/uki</b>ディレクトリにいるユーザから見た<b>myprog</b>の相対パスは<b>src/myprog</b>または<b>./src/myprog</b>となります。ここで、「<b>.</b>（ドット）」はカレントディレクトリをあらわします。</p>

<figure style="text-align:center;">
<img src="./img/usage_002.png" alt="Example of absolute/relative path">
<figcaption><b>図1-2: </b>絶対パスと相対パスの例。相対パスが示すディレクトリやファイルはカレントディレクトリによって決まります。</figcaption>
</figure>

<p>単に「パス」と書いてある場合、絶対パス・相対パスどちらを使っても構いません。</p>

<h2 id="pwd">現在位置を確認する</h2>
<p>いまどこのディレクトリにいるのか、つまりカレントディレクトリを確認するには<code>pwd(1)</code>を実行します。</p>

<pre><code><b class="user">pwd</b>
/home/uki</code></pre>

<p>キーボードから<code>pwd</code>と打鍵してEnterキーを入力すると、カレントディレクトリの絶対パスが画面に表示されます。この実行例では<b>/home/uki</b>がカレントディレクトリのようです。</p>

<p>システム構築の手順書によっては、相対パスを用いてコマンド実行の指示をおこなうものもあります。相対パスが指し示すファイルやディレクトリはカレントディレクトリによって左右されます。したがって慣れないうちは常にカレントディレクトリを確認するといいでしょう。</p>

<h2 id="ls">ディレクトリの中身を見る</h2>
<p>ディレクトリの中身を表示するには<code>ls(1)</code>を実行します。</p>

<pre><code><b class="user">ls</b>
src
<b class="user">file src</b>
src: directory</code></pre>

<p>この実行例では、カレントディレクトリに<b>src</b>というディレクトリかファイルがあるようです。一見どちらかわからないので<code>file(1)</code>コマンドで種類を判定してみたところ、ディレクトリだとわかりました。</p>

<div class=referbox>
<img src="/img/info.png" alt="info">
<div class="text"><p>ディレクトリの中身を表示するにせよもっと効率よくファイルかディレクトリかを判別できないものでしょうか。実は多くのUnixコマンドでは、ユーザがコマンドへあるオプションを渡すことでコマンドの動作や出力結果を変更できます。そのオプションはコマンドによってそれぞれ異なります。コマンド特有のオプションを調べるにはオンラインマニュアルを読むのが一番ですが、Unixそのものに慣れないうちはGoogle検索に頼ってもいいでしょう。</p></div>
</div>

<p><code>ls(1)</code>にディレクトリへのパスを渡して実行すると、そのディレクトリの中身が出力されます。</p>

<pre><code><b class="user">ls src</b>
myprog</code></pre>

<div class="referbox">
<img src="/img/warn.png" alt="warn">
<div class="text"><p>上記コマンドライン例では、<code>ls</code>のあとに半角スペースが1つ付いてます。コマンドにファイル名やディレクトリ名、オプションなどを渡すときは半角スペースで区切ることを忘れないでください。コマンド例に半角スペースがあるかどうかも注意し、その通り打鍵し実行しましょう。</p></div>
</div>

<h2 id="cd">ディレクトリを移動する</h2>
<p>カレントディレクトリから別ディレクトリへ移動するには<code>cd(1)</code>を実行します。</p>

<pre><code><b class="user">pwd</b>
/home/uki
<b class="user">ls</b>
src
<b class="user">cd ./src</b>
<b class="user">pwd</b>
/home/uki/src
<b class="user">ls</b>
myprog</code></pre>

<p>オプションをなにもつけずに<code>cd(1)</code>すると、ログインユーザのホームディレクトリまで移動します。</p>

<pre><code><b class="user">cd</b>
<b class="user">pwd</b>
/home/uki</code></pre>

<p>最初のうちは<code>cd(1)</code>したあとに<code>pwd(1)</code>や<code>ls(1)</code>を実行し、自分がいまどこのディレクトリにいてそのディレクトリにはどのようなファイルがあるのかを常に把握しておく癖をつけておくと混乱しにくくなります。</p>

<h2 id="mkdir">ディレクトリを作る</h2>
<p>ディレクトリの作成には<code>mkdir(1)</code>に作りたいディレクトリのパスを渡します。たとえば<b>mydir</b>という名前のディレクトリをカレントディレクトリに作りたいときは次のように実行します。</p>

<pre><code><b class="user">mkdir mydir</b></code></pre>

<p>当然<b>/home/uki/mydir</b>や<b>./mydir</b>といったように絶対パスや相対パス指定でも構いません。</p>

<h2 id="rmdir">ディレクトリを消す</h2>
<p>ディレクトリを削除するには<code>rmdir(1)</code>に削除対象のディレクトリへのパスを渡します。上で作ったばかりのディレクトリを消すには次のように実行します。</p>

<pre><code><b class="user">rmdir mydir</b></code></pre>

<p>なお、削除対象のディレクトリにディレクトリやファイルが存在すると<code>rmdir(1)</code>の実行は以下のように失敗します。</p>

<pre><code><b class="user">rmdir not_empty_dir</b>
rmdir: not_empty_dir: Directory not empty</code></pre>

<p>中身ごとディレクトリを削除したいときは後述する<code>rm(1)</code>コマンドの<code>-f</code>と<code>-r</code>オプションを使うといいでしょう。しかし、削除されたディレクトリやファイルは基本的には復元不可能です。注意して実行してください。</p>

<h2 id="less">ファイルの中身を見る</h2>
<p><code>ls(1)</code>でファイルの一覧を取得しても、それらのファイルになにが書かれているのかを調べたいときもあります。<code>less(1)</code>のようなページャソフトウェアを使うことで、画面上にファイルの中身を映せます。<code>less(1)</code>に中身を読みたいファイル名を渡し実行してください。</p>

<pre><code><b class="user">less test.txt</b></code></pre>

<p>画面上に<b>test.txt</b>の内容が表示されます。<code>less(1)</code>の操作方法はおおよそ以下の表のとおりです。前方一致・後方一致の検索もできますが、ここでは説明を省きます。他の機能についてはオンラインマニュアルなどを参照してください。</p>

<table>
  <thead>
    <tr>
      <td>操作</td>
      <td>入力</td>
    </tr>
  </thead>
  <tbody>
  <tr>
    <td>一行下へスクロールする</td>
    <td>j</td>
  </tr>
  <tr>
    <td>一行上へスクロールする</td>
    <td>k</td>
  </tr>
  <tr>
    <td>一ページ下へスクロールする</td>
    <td>SPACE</td>
  </tr>
  <tr>
    <td>一ページ上へスクロールする</td>
    <td>b</td>
  </tr>
  <tr>
    <td><code>less(1)</code>を終了する</td>
    <td>q</td>
  </tr>
  </tbody>
</table>

<h2 id="mv">ファイルを移動する・名前を変える</h2>
<p>ファイルやディレクトリのパスを変えたり名前を変更するには<code>mv(1)</code>を使います。このコマンドの書式は次のようになっています。</p>

<pre><code><b class="user">mv [移動元のパス] [移動先のパス]</b></code></pre>

<p>ここで、ファイル<b>/home/uki/test.txt</b>を<b>/home/uki/src/test.txt</b>へ移動したいとしましょう。<b>/home/uki/src</b>ディレクトリは既に存在するものとします。このとき<code>mv(1)</code>を次のように実行します。</p>

<pre><code><b class="user">mv /home/uki/test.txt /home/uki/src/test.txt</b></code></pre>

<p><code>mv(1)</code>にはファイルやディレクトリの名前変更もできます。いま移動した<b>/home/uki/src/test.txt</b>を<b>/home/uki/src/renamed.txt</b>にしたいとき、次のように<code>mv(1)</code>を実行します。</p>

<pre><code><b class="user">mv /home/uki/src/test.txt /home/uki/src/renamed.txt</b></code></pre>

<p>絶対パスではなく相対パスでの指定も可能です。</p>

<h2 id="rm">ファイルを消す</h2>
<p>ファイルやディレクトリの削除には<code>rm(1)</code>を使います。削除対象のファイルやディレクトリのパスを指定します。たとえば<b>test.txt</b>を削除したいときは以下のように実行します。</p>

<pre><code><b class="user">rm test.txt</b></code></pre>

<p>このコマンド実行により<b>test.txt</b>は完全に削除され、復元できません。このコマンドを使うときは細心の注意を払ってください。</p>
<hr>
<footer>
<div style="text-align:center;padding-top:2em;padding-bottom:2em;"><a rel="license" href="https://creativecommons.org/publicdomain/zero/1.0/"><img src="https://i.creativecommons.org/p/zero/1.0/88x31.png" alt="CC0" /></a></div>
<p>To the extent possible under law, <a href="mailto:uki@e-yuuki.org">Yuuki Enomoto</a> has waived all copyright and related or neighboring rights to e-yuuki.org. This work is published from: Japan.</p>
</footer>
</div></body>
</html>
