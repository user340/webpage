<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<style>
@media print, screen and (min-width:640px){ code{line-height:1.4;font-size:80%;} .inner{margin: auto auto; line-height:1.75; letter-spacing:0.05em;width:38em;text-align: justify; text-justify: inter-character; color: #333333;} pre{padding-top:1em; padding-left:2em; padding-right:2em; padding-bottom:1em; line-height:0; border:solid 1px; border-radius:1em; white-space:pre-wrap;} p{text-indent:1em;}}
@media only screen and (max-width:640px){.inner{font-size:80%; margin:auto auto; line-height:1.75; letter-spacing:0.05em; width:25em; text-align:justify; text-justify: inter-character; color: #333333;} pre{padding-top:1em; padding-left:2em; padding-right:2em; padding-bottom:1em; line-height:0; border:solid 1px; border-radius:1em; white-space:pre-wrap;} code{font-size:70%; line-height:1.4;} p{text-indent:1em;}}
</style>
<title>e-yuuki.org</title>
</head>
<body><div class="inner">
<h1>CUIメーラ&mdash;&mdash;NeoMutt</h1>
<hr>
<h2>NeoMuttとは</h2>
<p><code>neomutt(1)</code>はコマンドラインで利用できるメールクライアントです。名前の通り、メールクライアントmuttからforkしたソフトウェアです。</p>

<p>CUIでメールクライアントを使う利点として省メモリ・省スペースが挙げられます。特に<code>tmux(1)</code>と組み合わせて使うと、ひとつの画面でメールを見ながら作業したり、メールを書いている途中で調べものをしたりするのが楽になります。Thunderbirdではメールへの署名や暗号化にプラグインが別途必要ですが、<code>neomutt(1)</code>では標準でその機能が提供されています。</p>

<h2>インストール</h2>
<p><code>pkgsrc(7)</code>ではmail/neomuttパッケージとして提供されています。SMTPサーバへの認証にsecurity/cy2-plainパッケージも必要です。</p>

<pre><code># cd /usr/pkgsrc/mail/neomutt
# make install clean clean-depends
# cd /usr/pkgsrc/security/cy2-plain
# make install clean clean-depends</code></pre>

<h2>設定ファイル $HOME/.muttrc</h2>
<p>ここではGoogleのGmailアカウントを使ったメール送受信を<code>neomutt(1)</code>上で実現します。<code>neomutt(1)</code>の設定ファイルは$HOME/.muttrcです。</p>

<h3>ユーザ名とパスワード</h3>
<p>Gmailアカウント名とそのパスワードを変数に格納しておきます。</p>

<pre><code>set my_user = "Gmailのメールアドレス"
set my_pass = "パスワード"</code></pre>

<h3>IMAP</h3>
<p>IMAPでメールを読めるように設定します。</p>

<pre><code>set folder = "imaps://$my_user@imap.gmail.com:993"
set imap_pass = $my_pass
set spoolfile = +INBOX
mailboxes = +INBOX
set header_cache = $HOME/.mutt/cache/header
set postponed = +[Imap]/Drafts
set record = +[Gmail]/sent</code></pre>

<h3>SMTP</h3>
<p>メール送信のためにSMTPサーバの認証の設定を書きます。</p>

<pre><code>set from = $my_user
set use_from = yes
set editor = vim # 任意のエディタを書く。

set smtp_url = "smtps://$my_user:$my_pass@smtp.gmail.com/"
set ssl_force_tls = yes
set ssl_starttls = yes
# If smtp_authenticators is ``unset'' (the default)
# NeoMutt will try all available methods,
# in order from most-secure to least-secure.
unset smtp_authenticators</code></pre>

<h3>パスワードを平文で書きたくない場合</h3>
<p>パスワードを平文でファイルに書きたくない場合は、あらかじめパスワードの文字列をGnuPGで暗号化しておき、<code>neomutt(1)</code>が設定ファイルを読み込むときに復号するような設定をします。</p>

<p>安全のためメモリファイルシステム上に<code>set my_pass = "パスワード"</code>という内容のテキストファイルを作ります。GnuPGでそのファイルを暗号化し、元のテキストファイルを削除、暗号化されたファイルを$HOME/.muttディレクトリ以下に移動してください。そして<code>set my_pass = "パスワード"</code>の代わりに以下の設定を使ってください。</p>

<pre><code>source "gpg2 -dq $HOME/.mutt/password.gpg |"</code></pre>

<h2>使い方</h2>
<p>設定ファイルができあがったなら、<code>neomutt(1)</code>を実行します。簡単な使いかたは画面上部に表示されています。</p>

<hr>
<footer>
<div style="text-align:center;padding-top:2em;padding-bottom:2em;"><a rel="license" href="https://creativecommons.org/publicdomain/zero/1.0/"><img src="https://i.creativecommons.org/p/zero/1.0/88x31.png" alt="CC0" /></a></div>
<p>To the extent possible under law, <a href="mailto:uki@e-yuuki.org">Yuuki Enomoto</a> has waived all copyright and related or neighboring rights to e-yuuki.org. This work is published from: Japan.</p>
</footer>
</div></body>
</html>
