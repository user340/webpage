<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<style>
@media print, screen and (min-width:640px){ code{line-height:1.4;} .inner{margin: auto auto; line-height:1.75; letter-spacing:0.05em;width:38em;text-align: justify; text-justify: inter-ideograph; color: #333333;} pre{padding-top:1em; padding-left:2em; padding-right:2em; padding-bottom:1em; line-height:0; border:solid 1px; border-radius:1em; white-space:pre-wrap;}p{text-indent:1em;}}
@media only screen and (max-width:640px){.inner{font-size:80%; margin:auto auto; line-height:1.75; letter-spacing:0.05em; width:25em; text-align:justify; text-justify: inter-ideograph; color: #333333;} pre{padding-top:1em; padding-left:2em; padding-right:2em; padding-bottom:1em; line-height:0; border:solid 1px; border-radius:1em; white-space:pre-wrap;} code{font-size:70%; line-height:1.4;}}p{text-indent:1em;}
</style>
<title>e-yuuki.org</title>
</head>
<body><div class="inner">
<h1>アンチウイルス&mdash;&mdash;ClamAV&reg;</h1>
<hr>
<p>ClamAV&reg;はFLOSSのアンチウイルスエンジンです。WindowsやmacOS・GNU/Linux・BSD Unixで動作します。</p>

<h2>目次</h2>
<ol>
  <li><a href="#install">インストール</a></li>
  <li><a href="#config">設定ファイル&mdash;&mdash;/usr/pkg/etc/clamd.conf</a></li>
  <li><a href="#ref">参考文献</a></li>
</ol>

<h2 id="install">インストール</h2>
<p><code>pkgsrc(7)</code>ではsecurity/clamavパッケージで提供されています。</p>

<pre><code># cd /usr/pkgsrc/security/clamav
# make install clean clean-depends</code></pre>

<p>ウイルスデータベースを更新するfreshclamdと、アンチウイルスデーモン<code>clamd(8)</code>の自動起動を設定し、それぞれをservice(8)経由で実行します。</p>

<pre><code># cp /usr/pkg/share/examples/rc.d/freshclamd /etc/rc.d
# cp /usr/pkg/share/examples/rc.d/clamd /etc/rc.d</code></pre>


<pre><code># echo "freshclamd=YES" >> /etc/rc.conf
# echo "clamd=YES" >> /etc/rc.conf</code></pre>

<pre><code># service freshclamd start
# service clamd start</code></pre>

<h2 id="config">設定ファイル&mdash;&mdash;/usr/pkg/etc/clamd.conf</h2>
<p><code>clamd(8)</code>の設定ファイルは<code>clamd.conf(5)</code>です。以下にデフォルトとの差分を示します。</p>

<pre><code>--- /usr/pkg/share/examples/clamav/clamd.conf	2018-09-16 17:34:32.000000000 +0900
+++ /usr/pkg/etc/clamd.conf	2018-09-18 18:20:49.323386782 +0900
@@ -11,7 +11,7 @@
 # LogFile must be writable for the user running daemon.
 # A full path is required.
 # Default: disabled
-#LogFile /tmp/clamd.log
+LogFile /var/log/clamd.log
 
 # By default the log file is locked for writing - the lock protects against
 # running clamd multiple times (if want to run another clamd, please
@@ -28,11 +28,11 @@
 # in bytes just don't use modifiers. If LogFileMaxSize is enabled, log
 # rotation (the LogRotate option) will always be enabled.
 # Default: 1M
-#LogFileMaxSize 2M
+LogFileMaxSize 2M
 
 # Log time with each message.
 # Default: no
-#LogTime yes
+LogTime yes
 
 # Also log clean files. Useful in debugging but drastically increases the
 # log size.
@@ -54,7 +54,7 @@
 
 # Enable log rotation. Always enabled when LogFileMaxSize is enabled.
 # Default: no
-#LogRotate yes
+LogRotate yes
 
 # Log additional information about the infected file, such as its
 # size and hash, together with the virus name.
@@ -67,7 +67,7 @@
 
 # Optional path to the global temporary directory.
 # Default: system specific (usually /tmp or /var/tmp).
-#TemporaryDirectory /var/tmp
+TemporaryDirectory /var/shm
 
 # Path to the database directory.
 # Default: hardcoded (depends on installation options)
@@ -75,7 +75,7 @@
 
 # Only load the official signatures published by the ClamAV project.
 # Default: no
-#OfficialDatabaseOnly no
+OfficialDatabaseOnly yes
 
 # The daemon can work in local mode, network mode or both. 
 # Due to security reasons we recommend the local mode.</code></pre>

<p>/usr/pkg/etc/clamd.conf内にコメントで設定項目の説明が書かれていますから、そこまで難しくはないでしょう。設定ファイルを変更したなら、<code>service(8)</code>から<code>clamd(8)</code>を再起動し、設定をデーモンに反映させてください。</p>

<pre><code># service clamd restart</code></pre>

<h2 id="ref">参考文献</h2>
<dl>
<dt><a href="https://www.clamav.net">ClamavNet</a></dt>
<dd>ClamAV&reg;公式Webページ。</dd>
</dl>
<hr>
<footer>
<div style="text-align:center;padding-top:2em;padding-bottom:2em;"><a rel="license" href="https://creativecommons.org/publicdomain/zero/1.0/"><img src="https://i.creativecommons.org/p/zero/1.0/88x31.png" alt="CC0" /></a></div>
<p>To the extent possible under law, <a href="mailto:uki@e-yuuki.org">Yuuki Enomoto</a> has waived all copyright and related or neighboring rights to e-yuuki.org. This work is published from: Japan.</p>
</footer>
</div></body>
</html>

